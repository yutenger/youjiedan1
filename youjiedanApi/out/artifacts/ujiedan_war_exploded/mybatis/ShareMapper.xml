<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE mapper
  PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
  "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<!-- namespace:命名空间 -->
<mapper namespace="com.stardai.manage.mapper.ShareMapper">

	<!--查询金额与邀请的人数-->
	<select id="updateSharePerson" resultType="com.stardai.manage.response.ResponseShareUser">
		SELECT
		share_count,
		share_money,
		share_url,
		share_give,
		two_dimension_url
		FROM
		yjd_share_user
		WHERE
		user_id = #{userId}
	</select>

	<!-- 没有数据添加一条-->
	<insert id="addSharePerson">
		INSERT INTO yjd_share_user (
		user_id,
		share_url,
		two_dimension_url
		)
		VALUES
		(
		#{userId},
		#{shareUrl},
		#{twoDimensionUrl}
		);
	</insert>
	
	<!--查询分享链接-->
	<select id="queryShareUrl" resultType="String">
		SELECT
		url
		FROM
		yjd_share_url
		WHERE
		id=#{id}
	</select>
	
	<!--将推荐人的表中的次数+1和赠送金额增加 -->
	<update id="updateShareUserMoney">
		UPDATE yjd_share_user
		SET 
		 share_count = (share_count + 1),
		 share_money = (share_money + share_give)
		WHERE
		 user_id =#{userId}
	</update>
	
	<!--查询分享链接(1.2.0版本以前使用)-->
	<select id="queryShareGive" resultType="Integer">
		SELECT
		share_give
		FROM
		yjd_share_user
		WHERE
		 user_id =#{userId}
	</select>

	<!--查询分享链接和文案(1.2.0版本以后使用)-->
	<select id="queryShareUrlAndCopy" resultType="com.stardai.manage.response.ResponseShareUrl">
		SELECT
		url,
		title,
		subtitle
		FROM
		yjd_share_url
		WHERE
		id =#{id}
	</select>
	
	
	<!--把二维码链接更新到数据库里-->
	<update id="updateTwoDimensionUrl">
		UPDATE yjd_share_user
		SET 
		 two_dimension_url = #{twoDimensionUrl}
		WHERE
		 user_id =#{userId}
	</update>
</mapper>