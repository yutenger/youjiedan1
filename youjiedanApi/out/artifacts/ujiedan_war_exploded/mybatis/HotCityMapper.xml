<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE mapper
  PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
  "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<!-- namespace:命名空间 -->
<mapper namespace="com.stardai.manage.mapper.HotCityMapper">

	

	<!-- 修改关注城市-->
	<update id="updateCitiesByUserId">
		UPDATE yjd_user_info
		SET
		cities = #{city}
		WHERE
		user_id = #{userId}
	</update>
	
	<!-- 获取城市列表 -->
	<select id="queryCityList" resultType="com.stardai.manage.pojo.OrderCityList">
		SELECT
		id AS area_id,
		first_letter,
		city_name AS area_name,
		city_code AS area_code 
		FROM
		yjd_sys_area_code 
		WHERE
		city_code != ""
	  	and first_letter between 'A' and 'Z'
		GROUP BY
		city_name,
		first_letter 
		ORDER BY
		first_letter,
		city_code

	</select>
	
	<!-- 前端定位的城市获取的编码是计算到县区的，这里要把区编码转成对应的城市编码-->
	<select id="getCityCodeTransform" resultType="String">
		SELECT
		city_code
		from
		yjd_sys_area_code
		where
		area_code = #{cityCode}
			
	</select>
	
	<!-- 根据城市编码查询城市名称 -->
	<select id="getCityNameByCityCode" resultType="String">
		SELECT
		city_name 
		FROM
		yjd_sys_area_code 
		WHERE
		city_code = #{cityCode}
		LIMIT 1
	</select>


	<!-- 根据城市名称查询城市编码-->
	<select id="getCityCodeByCityName" resultType="String">
		SELECT
		city_code
		FROM
		yjd_sys_area_code
		WHERE
		city_name = #{cityName}
		and city_code != ''
		LIMIT 1
	</select>
	<!-- 根据城市编码查询城市名称 -->
	<select id="getCityCodeAndNameByCityCode" resultType="HashMap">
		SELECT
		city_name as areaName,
		city_code as areaCode
		from
		yjd_sys_area_code
		where
		city_code in
			<foreach collection="cityCodes" item="city" index="index" open="("
				close=")" separator=",">
				#{city}
			</foreach>
		GROUP BY city_code	
	</select>
	
	
	
</mapper>